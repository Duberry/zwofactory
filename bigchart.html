<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>zwofactory</title>
    <link rel="stylesheet" href="bigchart.css" />
</head> 
<body>
<h1>zwofactory</h1>

<div class="grid">
    <div class="u-1-4">
        <label for="txtName">Name</label>
        <input type="text" id="txtName" autofocus />
    </div>
    <div class="u-1-4">
        <label for="txtAuthor">Author</label>
        <input type="text" id="txtAuthor" />
    </div>
    <div class="u-1-4">
        <label for="txtTags">Tags</label>
        <input type="text" id="txtTags" />
    </div>
    <div class="u-1-4">
        <label for="txtDescription">Description</label>
        <textarea id="txtDescription" rows="2"></textarea>
    </div>
</div>

<div id="divControls" class="grid controls">
    <div class="u-1-10">
        <button class="control z1" data-ftp="50">Z1</button>
    </div>
    <div class="u-1-10">
        <button class="control z2" data-ftp="60">Z2</button>
    </div>
    <div class="u-1-10">
        <button class="control z3" data-ftp="70">Z3</button>
    </div>
    <div class="u-1-10">
        <button class="control z4" data-ftp="80">Z4</button>
    </div>
    <div class="u-1-10">
        <button class="control z5" data-ftp="90">Z5</button>
    </div>
    <div class="u-1-10">
        <button class="control z6" data-ftp="100">Z6</button>
    </div>
    <div class="u-1-10">
        <button class="control wu" data-ftp="">warm up</button>
    </div>
    <div class="u-1-10">
        <button class="control cd" data-ftp="">cool down</button>
    </div>
    <div class="u-1-10">
        <button class="control fr" data-ftp="">free ride</button>
    </div>
    <div class="u-1-10">
        <button class="control te">text event</button>
    </div>
</div>

<div class="grid">
<div class="u-1">Move left, Move right, delete, FTP, Duration, count, etc.</div>
</div>

<div id="divSegmentChart" class="u-4-5">
    <input type="radio" name="segment" id="x00" /><label for="x00" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label> 
    <input type="radio" name="segment" id="x01" /><label for="x01" class="segment"><div style="padding-top: 20px"><div class="z4" style="width:150px;"></div></div></label>
    <input type="radio" name="segment" id="x02" /><label for="x02" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x03" /><label for="x03" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x04" /><label for="x04" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x05" /><label for="x05" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x06" /><label for="x06" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x07" /><label for="x07" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x08" /><label for="x08" class="segment"><div style="padding-top: 20px"><div class="z4" style="width:150px;"></div></div></label>
    <input type="radio" name="segment" id="x09" /><label for="x09" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x10" /><label for="x10" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x11" /><label for="x11" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x12" /><label for="x12" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x13" /><label for="x13" class="segment"><div style="padding-top: 20px"><div class="z4" style="width:150px;"></div></div></label>
    <input type="radio" name="segment" id="x14" /><label for="x14" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x15" /><label for="x15" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x16" /><label for="x16" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x17" /><label for="x17" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x18" /><label for="x18" class="segment"><div style="padding-top: 20px"><div class="z4" style="width:150px;"></div></div></label>
    <input type="radio" name="segment" id="x19" /><label for="x19" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
    <input type="radio" name="segment" id="x20" /><label for="x20" class="segment"><div style="padding-top: 50px"><div class="z3" style="width:50px;"></div></div></label>
    <input type="radio" name="segment" id="x21" /><label for="x21" class="segment"><div style="padding-top: 20px"><div class="z2" style="width:75px;"></div></div></label>
</div>


<script>
    document.getElementById('divControls').addEventListener('click', function(e) {
        if (e.target.tagName == 'BUTTON') addSegment(e.target);
    });


    document.getElementById('btnMoveSegmentUp').addEventListener('click', function(e) {
        var selectedSegment = getSelectedSegment();
        if (!selectedSegment) return;
    });


    document.getElementById('btnMoveSegmentDown').addEventListener('click', function(e) {
        var selectedSegment = getSelectedSegment();
        if (!selectedSegment) return;
    });


    document.getElementById('btnRemoveSegment').addEventListener('click', function(e) {
        var selectedSegment = getSelectedSegment();
        if (selectedSegment) selectedSegment.parentNode.removeChild(segmentElement);
    });


    function addSegment(sourceElement) {
        var templ = document.getElementById('labelSegmentTemplate');
        var cloned = templ.cloneNode(true);
        cloned.removeAttribute('id');
        cloned.classList.remove('template');
        var guid = createGuid();
        var newSegmentId = 'div' + guid;
        cloned.id = newSegmentId;
        cloned.querySelector('input[type=radio]').id = "rb" + guid;
        cloned.querySelector('input[data-ftp]').value = sourceElement.getAttribute('data-ftp');
        cloned.querySelector('div:first-child').classList.add(sourceElement.classList[1]);
        cloned.querySelector('input[data-time]').value = "5";
        document.getElementById('divSegmentList').appendChild(cloned);
        var appendedElement = document.querySelector('#' + newSegmentId + ' input[data-time]');
        appendedElementx.focus();
        appendedElement.select();
    }


    function createGuid() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
            return v.toString(16);
        });
    }

    function findAncestorByClass (el, cls) {
        while ((el = el.parentElement) && !el.classList.contains(cls));
        return el;
    }
</script>

</body>
</html>
